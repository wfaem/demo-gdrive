import{jsx as c,jsxs as k}from"@dropins/tools/preact-jsx-runtime.js";import"./ShippingMethods.js";import{events as f}from"@dropins/tools/event-bus.js";import"@dropins/tools/preact-hooks.js";import"./getCart.graphql.js";import{classes as h}from"@dropins/tools/lib.js";import{Card as d,Icon as p,Image as O}from"@dropins/tools/components.js";import"./BillToShippingAddress.js";import{useText as g}from"@dropins/tools/i18n.js";import*as t from"@dropins/tools/preact-compat.js";import{useState as L,useCallback as v,useEffect as E}from"@dropins/tools/preact-compat.js";const _=r=>t.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...r},t.createElement("g",{clipPath:"url(#clip0_4797_15331)"},t.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M10.25 20.91L1.5 17.55V6.51996L10.25 9.92996V20.91Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),t.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M6.24023 4.64001L14.9902 8.06001V11.42",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),t.createElement("path",{className:"error-icon",vectorEffect:"non-scaling-stroke",d:"M19 13.31L15.5 19.37H22.5L19 13.31Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),t.createElement("path",{className:"error-icon",vectorEffect:"non-scaling-stroke",d:"M19.0202 17.11H18.9802L18.9502 15.56H19.0502L19.0202 17.11ZM18.9602 18.29V18.06H19.0502V18.29H18.9602Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),t.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M19 12.16V6.51996L10.25 9.92996V20.91L14.27 19.37L14.4 19.32",stroke:"currentColor",strokeLinejoin:"round"}),t.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M1.5 6.51999L10.25 3.04999L19 6.51999L10.25 9.92999L1.5 6.51999Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})),t.createElement("defs",null,t.createElement("clipPath",{id:"clip0_4797_15331"},t.createElement("rect",{width:22,height:18.86,fill:"white",transform:"translate(1 2.54999)"})))),b=({onCartProductsUpdate:r,routeCart:i})=>{const[o,u]=L([]),l=e=>e.outOfStock||e.insufficientQuantity,n=v(()=>{if(!r)return;const e=o.filter(s=>s.outOfStock).map(s=>({uid:s.uid,quantity:0}));r(e)},[o,r]);if(E(()=>{const e=f.on("cart/data",s=>{const m=(s==null?void 0:s.items)||[];u(m.filter(l))},{eager:!0});return()=>{e==null||e.off()}},[]),o.length===0)return null;const a=!o.some(e=>e.insufficientQuantity);return c(S,{items:o,onRemoveOutOfStock:a?n:void 0,routeCart:i==null?void 0:i()})},S=({className:r,items:i,onRemoveOutOfStock:o,routeCart:u,...l})=>{const n=g({title:"Checkout.OutOfStock.title",message:"Checkout.OutOfStock.message",reviewCart:"Checkout.OutOfStock.actions.reviewCart",removeOutOfStock:"Checkout.OutOfStock.actions.removeOutOfStock"});return k(d,{className:h(["checkout-out-of-stock",r]),"data-testid":"checkout-out-of-stock",variant:"secondary",...l,children:[k("h4",{className:"checkout-out-of-stock__title",children:[c(p,{source:_,size:"16",stroke:"1"}),n.title]}),c("p",{className:"checkout-out-of-stock__message",children:n.message}),c("ol",{className:"checkout-out-of-stock__items",children:i.map(a=>c("li",{"data-testid":"out-of-stock-item",className:"checkout-out-of-stock__item",children:c(O,{loading:"eager",src:a.image.src,alt:a.image.alt,width:"100",height:"100",params:{width:100}})},a.sku))}),k("div",{className:"checkout-out-of-stock__actions",children:[u&&c("a",{"data-testid":"review-cart",className:"checkout-out-of-stock__action",href:u,children:n.reviewCart}),o&&c("button",{className:"checkout-out-of-stock__action","data-testid":"remove-out-of-stock",type:"button",onClick:o,children:n.removeOutOfStock})]})]})};export{b as O,_ as S};
